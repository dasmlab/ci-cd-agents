apiVersion: batch/v1
kind: Job
metadata:
  name: github-actions-buildah-job
spec:
  template:
    spec:
      containers:
      - name: runner
        image: <your-gh-runner-image>
        env:
        - name: GITHUB_TOKEN
          valueFrom:
            secretKeyRef:
              name: github-runner-secrets
              key: github_token
        - name: GITHUB_REPO_URL
          value: "https://github.com/YOUR_ORG/YOUR_REPO"  # Replace with your repo/org URL
        - name: RUNNER_NAME
          value: "k8s-runner-job"  # Optional: customize runner name
        - name: REGISTRY_PASSWORD
          valueFrom:
            secretKeyRef:
              name: registry-secrets
              key: password
        volumeMounts:
        - name: workspace
          mountPath: /workspace
      restartPolicy: Never
      volumes:
      - name: workspace
        emptyDir: {}
  backoffLimit: 0 